<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Escena 3D - Frases y Fotos</title>
  <!-- Three.js (con renderer CSS3D) -->
  <script src="https://unpkg.com/three@0.147.0/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.147.0/examples/js/renderers/CSS3DRenderer.js"></script>
  <style>
    /* Estilos básicos */
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;               /* Sin scroll, ocupamos pantalla completa */
      background: #ffffff;            /* Fondo blanco (se puede cambiar si se desea) */
      touch-action: none;             /* Deshabilita gestos de scroll en móviles */
      user-select: none;             /* Evita seleccionar texto accidentalmente */
    }
    #scene3d {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      overflow: hidden;
      /* No background-color here so it’s transparent over the hearts background */
    }
    /* HUD de inicio – pantalla completa semitransparente */
    #start-screen {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);   /* fondo negro semi-transparente */
      color: #ffffff;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-family: Arial, sans-serif;
      font-size: 1.5em;
      z-index: 1000;                /* encima de todo */
    }
    #start-screen span {
      padding: 20px;
      background: rgba(0,0,0,0.3);
      border-radius: 10px;
    }
    /* Fondo de corazones flotando */
    #bg-hearts {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      overflow: hidden;
      pointer-events: none;         /* Los corazones no interfieren con toques/clicks */
      z-index: 0;
    }
    .heart {
      position: absolute;
      bottom: 0;
      /* Tamaño base del corazón (ajustable) */
      width: 50px;
      height: 45px;
      /* Dibujar la forma de corazón utilizando pseudo-elementos */
    }
    .heart::before, .heart::after {
      content: "";
      position: absolute;
      top: 0;
      width: 26px;
      height: 40px;
      background: red;
      border-radius: 50px 50px 0 0;
    }
    .heart::before {
      left: 25px;
      transform: rotate(-45deg);
      transform-origin: 0 100%;
    }
    .heart::after {
      left: 0;
      transform: rotate(45deg);
      transform-origin: 100% 100%;
    }
    /* Clases para diferentes tamaños/opacidades de corazones (anillos de diferentes escalas) */
    .x1 { 
      transform: scale(0.9); 
      opacity: 0.6;
      left: 5%;
      animation: floating-heart 10s infinite cubic-bezier(0.5,0.5,0.5,0.5);
    }
    .x2 { 
      transform: scale(0.6); 
      opacity: 0.9;
      left: 25%;
      animation: floating-heart 12s infinite cubic-bezier(0.5,0.5,0.5,0.5);
    }
    .x3 { 
      transform: scale(0.8); 
      opacity: 0.8;
      left: 55%;
      animation: floating-heart 8s infinite cubic-bezier(0.5,0.5,0.5,0.5);
    }
    .x4 { 
      transform: scale(0.75);
      opacity: 0.9;
      left: 72%;
      animation: floating-heart 15s infinite cubic-bezier(0.5,0.5,0.5,0.5);
    }
    .x5 { 
      transform: scale(0.8); 
      opacity: 0.3;
      left: 88%;
      animation: floating-heart 9s infinite cubic-bezier(0.5,0.5,0.5,0.5);
    }
    .x6 { 
      /* escala default 1 */
      opacity: 1;
      left: 33%;
      animation: floating-heart 11s infinite cubic-bezier(0.5,0.5,0.5,0.5);
    }
    /* Animación de corazones flotantes (movimiento vertical y oscilación horizontal) */
    @keyframes floating-heart {
      0%   { opacity: 0; bottom: 0%;   left: 0%; }
      10%  { opacity: 1; bottom: 20%;  left: 70%; }
      20%  {           bottom: 40%;  left: 10%; }
      30%  {           bottom: 60%;  left: 50%; }
      40%  { opacity: 1; bottom: 80%;  left: 5%;  }
      48%  { opacity: 0; bottom: 100%; left: 60%; }
      100% { opacity: 0; bottom: 100%; left: 90%; }
    }
    /* Retraso escalonado para que los corazones suban uno tras otro */
    #bg-hearts .heart:nth-child(1) { animation-delay: 0s; }
    #bg-hearts .heart:nth-child(2) { animation-delay: 2s; }
    #bg-hearts .heart:nth-child(3) { animation-delay: 4s; }
    #bg-hearts .heart:nth-child(4) { animation-delay: 6s; }
    #bg-hearts .heart:nth-child(5) { animation-delay: 8s; }
    #bg-hearts .heart:nth-child(6) { animation-delay: 10s; }
    /* Estilos de los elementos de texto (frases) en la escena 3D */
    .phrase {
      font-family: "Arial", sans-serif;
      font-size: 1.2em;
      color: #000000;
      /* Se podría ajustar color/tamaño o añadir sombras según preferencia */
    }
    /* Asegurar que imágenes y frases en la escena no interfieran con puntero */
    .photo, .phrase {
      pointer-events: none;
    }
  </style>
</head>
<body>

  <!-- Contenedor de la escena 3D -->
  <div id="scene3d"></div>

  <!-- HUD de inicio -->
  <div id="start-screen"><span>Toca para iniciar</span></div>

  <!-- Fondo de corazones flotando (6 corazones con clases x1..x6) -->
  <div id="bg-hearts">
    <div class="heart x1"></div>
    <div class="heart x2"></div>
    <div class="heart x3"></div>
    <div class="heart x4"></div>
    <div class="heart x5"></div>
    <div class="heart x6"></div>
  </div>

  <!-- Script de la escena 3D -->
  <script>
    // Variables globales de Three.js
    let camera, scene, renderer;
    let group;  // grupo que contendrá todas las frases y fotos

    // Posiciones predefinidas de las frases (ejemplo; usar las reales si se proveen)
    const frases = [
      "Te amo",
      "Eres mi vida",
      "Mi sol",
      "Siempre juntos",
      "Amor eterno",
      "Mi luz"
    ];
    // Coordenadas ejemplo para las frases (debe reemplazarse con las reales si se tienen)
    const frasePositions = [
      { x: -20, y:  40, z: -10 },
      { x:  30, y:  30, z:  20 },
      { x: -35, y: -10, z:  15 },
      { x:  10, y: -30, z: -25 },
      { x:   0, y:  10, z: -30 },
      { x: -25, y:   0, z: -30 }
    ];

    // Datos de las fotos: definimos posiciones usando 3 anillos de distintos radios y alturas
    const fotos = [
      { url: "fotos/1.jpg", angle:  0,   radius: 250, y: 100 },
      { url: "fotos/2.jpg", angle:  60,  radius: 250, y:  60 },
      { url: "fotos/3.jpg", angle: 140, radius: 300, y:  20 },
      { url: "fotos/4.jpg", angle: 220, radius: 300, y: -20 },
      { url: "fotos/5.jpg", angle: 280, radius: 200, y: -60 },
      { url: "fotos/6.jpg", angle: 330, radius: 200, y: -100 }
    ];
    // Convertir angulo en radianes por conveniencia
    fotos.forEach(f => f.angleRad = f.angle * Math.PI/180);

    init();
    animate();

    function init() {
      // Crear escena
      scene = new THREE.Scene();

      // Crear cámara perspectiva (fov 60, aspecto segun pantalla, cerca=1, lejos=2000)
      const aspect = window.innerWidth / window.innerHeight;
      camera = new THREE.PerspectiveCamera(60, aspect, 1, 2000);
      // Ubicar cámara mirando hacia el origen
      camera.position.set(0, 0, 800);
      camera.lookAt(0, 0, 0);

      // Inicializar renderer CSS3D
      renderer = new THREE.CSS3DRenderer();
      renderer.setSize(window.innerWidth, window.innerHeight);
      // Añadir el renderer al contenedor #scene3d
      const sceneContainer = document.getElementById("scene3d");
      sceneContainer.appendChild(renderer.domElement);

      // Crear grupo para la nube de frases y fotos
      group = new THREE.Group();
      scene.add(group);

      // Añadir frases al grupo como CSS3DObjects
      for (let i = 0; i < frases.length; i++) {
        const texto = frases[i];
        const pos = frasePositions[i] || {x:0, y:0, z:0};
        // Crear elemento div para la frase
        const div = document.createElement('div');
        div.className = 'phrase';
        div.textContent = texto;
        // Establecer tamaño mínimo para el div (opcional, según contenido)
        div.style.padding = "5px 10px";
        // Crear CSS3DObject a partir del div
        const cssObject = new THREE.CSS3DObject(div);
        cssObject.position.set(pos.x, pos.y, pos.z);
        // Añadir al grupo
        group.add(cssObject);
      }

      // Añadir fotos al grupo como CSS3DObjects (en forma de elementos <img>)
      for (let f of fotos) {
        const img = document.createElement('img');
        img.className = 'photo';
        img.src = f.url;
        // Se puede ajustar el tamaño de imagen para que todas tengan dimensiones similares
        img.style.width = "150px";
        img.style.borderRadius = "10px";
        img.style.boxShadow = "0 0 10px rgba(0,0,0,0.5)";
        // Crear objeto CSS3D
        const photoObject = new THREE.CSS3DObject(img);
        // Calcular posición 3D a partir de ángulo, radio y altura (y)
        const x = f.radius * Math.cos(f.angleRad);
        const z = f.radius * Math.sin(f.angleRad);
        photoObject.position.set(x, f.y, z);
        // Opcional: orientar cada foto hacia el centro (rotación para que miren a la cámara)
        // Calculamos ángulo hacia el centro en el plano XZ y rotamos en Y
        photoObject.rotation.y = -f.angleRad;
        // Añadir al grupo
        group.add(photoObject);
      }

      // Manejar clic en pantalla de inicio para iniciar animaciones
      const startScreen = document.getElementById("start-screen");
      startScreen.addEventListener('click', () => {
        startScreen.style.display = 'none';  // ocultar HUD de inicio
      });

      // Ajustar escena en caso de redimensionamiento de ventana
      window.addEventListener('resize', onWindowResize);
    }

    function onWindowResize() {
      const width = window.innerWidth;
      const height = window.innerHeight;
      camera.aspect = width / height;
      camera.updateProjectionMatrix();
      renderer.setSize(width, height);
    }

    // Animación de rotación suave
    function animate() {
      requestAnimationFrame(animate);
      // Rotar lentamente el grupo completo de frases+fotos
      group.rotation.y += 0.001;  // velocidad de rotación suave
      renderer.render(scene, camera);
    }
  </script>
</body>
</html>
